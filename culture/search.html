<!DOCTYPE html>
<html lang="ko">
  <head>
    <meta charset="UTF-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <!-- CSS -->
    <link rel="stylesheet" href="./assets/assets-park/css/search.min.css" />
    <!-- íŒŒë¹„ì½˜ -->
    <link rel="shortcut icon" href="assets/favicon/bolt-solid.ico" />
    <!-- í°íŠ¸ ì–´ì¸ -->
    <script src="https://kit.fontawesome.com/4691863309.js" crossorigin="anonymous"></script>
    <title>ë¬¸í™”ì¶©ì „</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/animate.css/4.1.1/animate.min.css" />
  </head>
  <body>
    <!-- header -->
    <div data-include="./inc/header.html"></div>

    <!-- loading -->
    <div id="loading"></div>

    <!-- search -->
    <div id="body-wrapper">
      <div id="body-content">
        <main>
          <section id="search_form_map">
            <h1 style="border-bottom: 1px solid rgb(210, 210, 210); margin: 20px auto 50px; font-size: 30px; padding: 0 0 30px 30px; font-weight: 600">ìƒì„¸ ê²€ìƒ‰ í˜ì´ì§€</h1>
            <!-- form -->
            <form action="#" id="searchForm">
              <fieldset style="width: 100%; min-width: none">
                <div class="field_wrapper">
                  <!-- ë‚ ì§œ+ì¥ë¥´ ì»¨í…Œì´ë„ˆ -->
                  <div class="date_genre_container">
                    <!-- ë‚ ì§œ ì„ íƒ -->
                    <div class="date_container">
                      <div class="date-title">ë‚ ì§œ</div>
                      <input type="date" name="" id="startDay" />
                    </div>

                    <!-- ì¥ë¥´ ì„ íƒ -->
                    <div class="genre_container">
                      <div class="category-title stepColor" id="genre_category_title">ì¥ë¥´</div>
                      <ul id="genre_buttons">
                        <li class="btn1" data-genre="ë¬´ìš©" value="ë¬´ìš©">ë¬´ìš©</li>
                        <li class="btn1" data-genre="ë®¤ì§€ì»¬" value="ë®¤ì§€ì»¬">ë®¤ì§€ì»¬</li>
                        <li class="btn1" data-genre="ì—°ê·¹" value="ì—°ê·¹">ì—°ê·¹</li>
                        <li class="btn1" data-genre="ì˜¤í˜ë¼" value="ì˜¤í˜ë¼">ì˜¤í˜ë¼</li>
                        <li class="btn1" data-genre="ì½˜ì„œíŠ¸" value="ì½˜ì„œíŠ¸">ì½˜ì„œíŠ¸</li>
                        <li class="btn1" data-genre="í´ë˜ì‹" value="í´ë˜ì‹">í´ë˜ì‹</li>
                      </ul>
                    </div>
                  </div>
                  <!-- ê²€ìƒ‰ (submit)ë²„íŠ¼ -->
                  <div class="title-cover" style="width: 100%">
                    <select name="searchType" id="searchType">
                      <option value="titleSearch">ì œëª©ê²€ìƒ‰</option>
                      <option value="stageSearch">ê³µì—°ì¥ê²€ìƒ‰</option>
                    </select>
                    <input type="search" id="query" placeholder="ê³µì—°ì œëª© ë˜ëŠ” ê³µì—°ì¥ ì…ë ¥" /><button type="submit" class="submitBtn"><i class="fa-solid fa-magnifying-glass"></i></button>
                  </div>
                </div>
              </fieldset>
            </form>

            <!-- ì§€ë„ í‘œì‹œ -->
            <div class="map-container">
              <div id="map" style="width: 100%; height: 40vw; max-height: 600px"></div>

              <!-- ì§€ì—­ ì„ íƒ ë²„íŠ¼ -->

              <div class="map-category-title">ì§€ì—­</div>
              <!-- <div class="map-category-title fold">ì§€ì—­</div> -->
              <!-- <div class="map-category-cover"></div> -->

              <div id="map-button-container">
                <ul id="map_buttons">
                  <li><button onclick="buttonClick(this.value)" class="btnJ" type="button" id="a" value="37.5666805,126.9784147">ì„œ ìš¸</button></li>
                  <li><button onclick="buttonClick(this.value)" class="btnJ" type="button" id="b" value="35.17944,129.07556">ë¶€ ì‚°</button></li>
                  <li><button onclick="buttonClick(this.value)" class="btnJ" type="button" id="c" value="35.87222,128.60250">ëŒ€ êµ¬</button></li>
                  <li><button onclick="buttonClick(this.value)" class="btnJ" type="button" id="d" value="37.45639,126.70528">ì¸ ì²œ</button></li>
                  <li><button onclick="buttonClick(this.value)" class="btnJ" type="button" id="e" value="35.15972,126.85306">ê´‘ ì£¼</button></li>
                  <li><button onclick="buttonClick(this.value)" class="btnJ" type="button" id="f" value="36.35111,127.38500">ëŒ€ ì „</button></li>
                  <li><button onclick="buttonClick(this.value)" class="btnJ" type="button" id="g" value="35.53889,129.31667">ìš¸ ì‚°</button></li>
                  <li><button onclick="buttonClick(this.value)" class="btnJ" type="button" id="h" value="36.48750,127.28167">ì„¸ ì¢…</button></li>
                  <li><button onclick="buttonClickDo(this.value)" class="btnJ" type="button" id="i" value="37.567167,127.190292">ê²½ ê¸°</button></li>
                  <li><button onclick="buttonClickDo(this.value)" class="btnJ" type="button" id="j" value="37.555837,128.209315">ê°• ì›</button></li>
                  <li><button onclick="buttonClickDo(this.value)" class="btnJ" type="button" id="k" value="36.628503,127.929344">ì¶© ë¶</button></li>
                  <li><button onclick="buttonClickDo(this.value)" class="btnJ" type="button" id="l" value="36.557229,126.779757">ì¶© ë‚¨</button></li>
                  <li><button onclick="buttonClickDo(this.value)" class="btnJ" type="button" id="m" value="35.716705,127.144185">ì „ ë¶</button></li>
                  <li><button onclick="buttonClickDo(this.value)" class="btnJ" type="button" id="n" value="34.819400,126.893113">ì „ ë‚¨</button></li>
                  <li><button onclick="buttonClickDo(this.value)" class="btnJ" type="button" id="o" value="36.248647,128.664734">ê²½ ë¶</button></li>
                  <li><button onclick="buttonClickDo(this.value)" class="btnJ" type="button" id="p" value="35.259787,128.664734">ê²½ ë‚¨</button></li>
                  <li><button onclick="buttonClickDo(this.value)" class="btnJ" type="button" id="q" value="33.50000,126.51667">ì œ ì£¼</button></li>
                </ul>
              </div>
            </div>
          </section>

          <!-- ê²°ê³¼ ì¶œë ¥ -->
          <div id="output_container">
            <a id="anchor"></a>
            <h2 id="title2"></h2>
            <div class="row_container"></div>
          </div>
        </main>

        <a href="#top" id="going_up"><i class="fa-solid fa-angles-up"></i></a>

        <!-- ìŠ¤í¬ë¦½íŠ¸ -->
        <script src="../node_modules/axios/dist/axios.min.js"></script>

        <!-- keyë“±ë¡ / servicesì™€ clusterer, drawing ë¼ì´ë¸ŒëŸ¬ë¦¬ ë¶ˆëŸ¬ì˜¤ê¸° -->
        <script type="text/javascript" src="//dapi.kakao.com/v2/maps/sdk.js?appkey=8b69768f7e98a4a1d4489b836f6a8972&libraries=services,clusterer,drawing"></script>

        <script>
          // kakao rest key
          const KAKAO_REST_KEY = "b204b408f1f9390af9b568c47045350e";

          /**
           *
           *
           * ë³€ìˆ˜
           */
          let searchGenre = null;
          let searchArea = null;

          let queryKeyword = "";
          const genreField = [];
          let chooseDate = null;

          // ìœ„ë„ ê²½ë„
          // let lngLocation = null;
          // let latLocation = null;
          var Lat = 0;
          var Lng = 0;

          var doLat = 0;
          var doLng = 0;

          // ë‹¬ë ¥ today placeholder
          const nowDate = new Date();
          // console.log(nowDate);
          // document.querySelector("#startDay").valueAsDate = new Date(nowDate.setDate(nowDate.getDate() + 1));
          document.querySelector("#startDay").valueAsDate = new Date(nowDate);

          // ì œëª©, ê³µì—°ì¥ ê²€ìƒ‰ êµ¬ë¶„
          // let searchType = true; // true : ì œëª©ê²€ìƒ‰  ,  false : ê³µì—°ì¥ê²€ìƒ‰
          let titleSearch = null;
          let stageSearch = null;
          // document.querySelector("#searchType").addEventListener("change", (e) => {
          //   if (e.currentTarget.value == "titleSearch") {
          //     titleSearch = e.currentTarget.value;
          //   } else {
          //     searchType = null;
          //     stageSearch = e.currentTarget.value;
          //   }
          // });

          /**
           *
           *
           * ì–‘ì‹ submitì‹œ ë³€ìˆ˜ í• ë‹¹ê³¼ search(), setCenter() ì‹¤í–‰
           */
          document.querySelector("#searchForm").addEventListener("submit", (e) => {
            e.preventDefault();

            document.querySelectorAll(".btn1").forEach((v, i) => {
              if (v.classList.contains("choiced")) {
                v.classList.add("animate__animated");
                v.classList.add("animate__pulse");

                console.log(v.dataset.genre);
                genreField.push(v.dataset.genre);
              }
            });
            // console.log("genreField : " + genreField);

            if (genreField.length == 0) {
              alert("ì¥ë¥´ë¥¼ ì„ íƒí•˜ì„¸ìš”. (ë³µìˆ˜ì„ íƒ ê°€ëŠ¥)");
            } else {
              chooseDate = document.querySelector("#startDay").value;
              console.log("chooseDate : " + chooseDate);

              const queryField = document.querySelector("#query");
              queryKeyword = queryField.value.trim();
              // console.log("queryKeyword : " + queryKeyword);
              search();

              // ê²€ìƒ‰ì‹œ ì¶œë ¥ë¶€ë¶„ìœ¼ë¡œ ì²œì²œíˆ ìŠ¤í¬ë¡¤
              setTimeout(() => {
                document.querySelector("#output_container").scrollIntoView({ behavior: "smooth" });
              }, 2000);

              setTimeout(() => {
                if (document.querySelector(".row_container").children.length == 0) {
                  document.querySelector("#title2").style.opacity = "0";
                  setTimeout(() => {
                    console.log("ë§ì¶¤ ì¶”ì²œ ê²°ê³¼ê°€ ì—†ìŠµë‹ˆë‹¤.");
                    title2.classList.add("animate__animated");
                    title2.classList.add("animate__fadeInUp");
                    title2.innerHTML = "ğŸ˜¢ ì•—! ì›í•˜ì‹œëŠ” ê³µì—°ì„ ì°¾ì„ ìˆ˜ ì—†ì–´ìš”.<br> <a href='#top' id='text_link'><h2 id='title3'>ë‹¤ë¥¸ ê²€ìƒ‰ í‚¤ì›Œë“œë¥¼ ì´ìš©í•´ ë³´ì„¸ìš”!</h2></a>";
                    document.querySelector("#title3").classList.add("animate__animated");
                    setInterval(() => {
                      document.querySelector("#title3").classList.toggle("animate__pulse");
                    }, 1000);
                  }, 1000);
                }
              }, 15000);
            }
          });

          function buttonClick(value) {
            let locationS = value.split(",");
            Array.from(locationS);
            Lat = locationS[0];
            Lng = locationS[1];
            setCenter();
          }

          function buttonClickDo(valueDo) {
            let locationS = valueDo.split(",");
            Array.from(locationS);
            doLat = locationS[0];
            doLng = locationS[1];
            setCenterOut();
          }

          /**
           *
           *
           * ì§€ë„ ì´ë™ì‹œí‚¤ê¸°
           */
          // ì‹œ ì§€ì—­ ì¤Œ ë ˆë²¨ 7
          function setCenter() {
            // ì´ë™í•  ìœ„ë„ ê²½ë„ ìœ„ì¹˜ë¥¼ ìƒì„±í•©ë‹ˆë‹¤
            var moveLatLon = new kakao.maps.LatLng(Lat, Lng);
            // ì§€ë„ ì¤‘ì‹¬ì„ ì´ë™ ì‹œí‚µë‹ˆë‹¤
            map.setCenter(moveLatLon);
            // ì¤Œ ë ˆë²¨ ì„¤ì •
            zoomIn();
            // ì¤Œ ì¸ ì•„ì›ƒ ì—¬ë¶€
            // setZoomable(false);
          }
          // ë„ ì§€ì—­ ì¤Œ ë ˆë²¨ 10
          function setCenterOut() {
            // ì´ë™í•  ìœ„ë„ ê²½ë„ ìœ„ì¹˜ë¥¼ ìƒì„±í•©ë‹ˆë‹¤
            var moveLatLon = new kakao.maps.LatLng(doLat, doLng);
            // ì§€ë„ ì¤‘ì‹¬ì„ ì´ë™ ì‹œí‚µë‹ˆë‹¤
            map.setCenter(moveLatLon);
            // ì¤Œ ë ˆë²¨ ì„¤ì •
            zoomOut();
            // ì¤Œ ì¸ ì•„ì›ƒ ì—¬ë¶€
            // setZoomable(false);
          }

          /**
           *
           *
           * ì¥ë¥´ ì„ íƒ
           * ì¥ë¥´ í•„í„°ë§ ë° í•´ë‹¹ json data êµ¬í˜„
           */

          let count = 1;

          async function search() {
            const list = document.querySelector("#show_list");

            // ë¡œë”©ì°½ ë„ìš°ê¸°
            document.querySelector("#loading").classList.add("active");

            // ê²€ìƒ‰ì‹œ ì¶”ì²œ í•­ëª© ì œê±°
            document.querySelector(".row_container").innerHTML = "";

            // ê²€ìƒ‰ì‹œ í‘¸í„° ì œê±°
            document.querySelector("#footer").style.display = "none";

            let json = null;

            try {
              // test json
              const response = await axios.get("http://localhost:3002/response");
              json = response.data.body.items.item;

              // API JSON ------------- ìˆ˜ì •
              // const response = await axios.get('http://api.kcisa.kr/openapi/service/rest/meta16/getkopis01', {
              //     params: {
              //         serviceKey: "b5c0289f-a465-4bd4-bb80-37b3b12a1150",
              //         numOfRows: 5,
              //         pageNo: 1,
              //     },
              //     header: {
              //         accept: "application/json",
              //     },
              // });
              // json = response.data.response.body.items.item;
              // console.log(json);
            } catch (error) {
              console.error(`[Error Code] ${error.code}`);
              console.error(`[Error Message] ${error.message}`);
              let alertMsg = error.message;

              if (error.response !== undefined) {
                const errorMsg = `${error.response.status} error - ${error.response.statusText}`;
                console.error(`[HTTP Status] ${errorMsg}`);
                alertMsg += `\n${errorMsg}`;
              }
              alert(alertMsg);
              return;
            } finally {
              document.querySelector("#loading").classList.remove("active");
            }

            console.log(json);

            // ë³€ìˆ˜
            console.log("queryKeyword : " + queryKeyword + "\nchooseDate : " + chooseDate + "\ngenreField : " + genreField);
            // ê²€ìƒ‰ì–´ : queryKeyword
            // ì„ íƒ ë‚ ì§œ : chooseDate
            // ì„ íƒ ì¥ë¥´ : genreField

            json.forEach((v, i) => {
              // console.log(v.temporalCoverage);
              const period = v.temporalCoverage.split("~");
              // console.log(period);
              const choosed = new Date(chooseDate);
              const startDate = new Date(period[0]);
              startDate.setFullYear(startDate.getFullYear() + 3);
              const endDate = new Date(period[1]);
              endDate.setFullYear(endDate.getFullYear() + 3);

              let A = BigInt(choosed.getTime());
              // console.log(A);
              let B = BigInt(startDate.getTime());
              let C = BigInt(endDate.getTime());
              const A1 = ("" + A).substring(0, 6);
              const B1 = ("" + B).substring(0, 6);
              const C1 = ("" + C).substring(0, 6);
              // console.log(A1);
              // console.log(B1);
              // console.log(C1);

              A = parseInt(A1); // ì„ íƒ
              B = parseInt(B1); // ì‹œì‘
              C = parseInt(C1); // ì—”ë“œ

              /**
               * ê²€ìƒ‰ ì¡°ê±´ì— ë”°ë¼ í•„í„°ë§
               */
              // if (count <= currentImg) {
              // ë‚ ì§œì„ íƒ
              // console.log("ì‹œì‘ì¼" + startDate.getTime());
              // console.log("ì„ íƒì¼" + choosed.getTime());
              // console.log("ë§ˆê°ì¼" + endDate.getTime());
              // console.log(v.subjectCategory);

              let titleFilter = null;
              const searchType = document.querySelector("#searchType");
              console.log(searchType.value == "titleSearch");

              if (searchType.value == "titleSearch") {
                // console.log("ì œëª©ìœ¼ë¡œ ê²€ìƒ‰í•©ë‹ˆë‹¤.");
                v.title.includes(queryKeyword) ? (titleFilter = true) : (titleFilter = false);
              } else {
                // console.log("ê³µì—°ì¥ ì´ë¦„ìœ¼ë¡œ ê²€ìƒ‰í•©ë‹ˆë‹¤.");
                v.spatialCoverage.includes(queryKeyword) ? (titleFilter = true) : (titleFilter = false);
              }

              if (genreField.includes(v.subjectCategory)) {
                // console.log(v.subjectCategory);
                // ì¥ë¥´ì„ íƒ
                // if (A >= B && A <= C && count <= 30) {
                if (A >= B && A <= C && count <= 30 && titleFilter) {
                  console.log(v.temporalCoverage);
                  console.log("title: " + v.title + " , stage : " + v.spatialCoverage);
                  // ê²€ìƒ‰ì–´

                  console.log("ê³µì—°ì¥ ì´ë¦„ìœ¼ë¡œ ê²€ìƒ‰í•©ë‹ˆë‹¤.");

                  // if (v.title.includes(queryKeyword) || v.spatialCoverage.includes(queryKeyword)) {
                  const div = document.createElement("div");
                  div.classList.add("rec_container");
                  div.classList.add("animate__animated");
                  div.classList.add("animate__fadeInUp");
                  div.style.setProperty("--animate-duration", count * 100 + 1000 + "ms");
                  count++;
                  // console.log(count);

                  const img = document.createElement("img");
                  img.classList.add("hvr-grow");
                  const h3 = document.createElement("h3");
                  const h4 = document.createElement("h4");
                  const p1 = document.createElement("p");
                  const p = document.createElement("p");

                  img.setAttribute("src", v.referenceIdentifier);
                  h3.innerHTML = v.title;
                  h4.innerHTML = v.spatialCoverage;

                  p1.innerHTML = v.subjectCategory;

                  /** apiê°€ ëŒ€ë¶€ë¶„ ê³¼ê±°ì˜ ê³µì—°ì •ë³´ ì´ê¸° ë•Œë¬¸ì— ê³µì—° ê¸°ê°„ì— ì„ì‹œë¡œ 3ë…„ì„ ë”í•´ì„œ í‘œí˜„í•©ë‹ˆë‹¤. */
                  let plusThreeYear = v.temporalCoverage.replaceAll("2020", "2023").replaceAll("2019", "2022").replaceAll("2018", "2021").replaceAll("2017", "2020");
                  p.innerHTML = plusThreeYear;
                  // ì›ë˜ ê³µì—°ê¸°ê°„
                  // p.innerHTML = v.temporalCoverage;
                  div.addEventListener("click", (e) => {
                    window.open(v.url);
                  });

                  div.appendChild(img);
                  div.appendChild(h3);
                  div.appendChild(h4);
                  div.appendChild(p1);
                  div.appendChild(p);

                  document.querySelector(".row_container").appendChild(div);
                }
              }
            });
          }

          /**
           *
           *
           * json data api
           * ë°ì´í„° ì¥ì†Œëª…ì„ ì¤‘ë³µì—†ì´ ë°°ì—´ë¡œ ì²˜ë¦¬
           * search_map í•¨ìˆ˜ í˜¸ì¶œì„ í†µí•´ ì§€ë„ì— í‘œì‹œ
           */
          (async () => {
            let json = null;

            // ë¡œë”©ì°½ ë„ìš°ê¸°
            document.querySelector("#loading").classList.add("active");

            try {
              // test json
              const response = await axios.get("http://localhost:3001/response");
              json = response.data.body.items.item;
              // console.log(json);

              // API JSON ------------- ìˆ˜ì •
              // const response = await axios.get('http://api.kcisa.kr/openapi/service/rest/meta16/getkopis01', {
              //     params: {
              //         serviceKey: "b5c0289f-a465-4bd4-bb80-37b3b12a1150",
              //         numOfRows: 100,
              //         pageNo: 1,
              //     },
              //     header: {
              //         accept: "application/json",
              //     },
              // });
              // json = response.data.response.body.items.item;
              // console.log(json);
            } catch (e) {
              console.error(e);
              alert("ìš”ì²­ì„ ì²˜ë¦¬í•˜ëŠ”ë° ì‹¤íŒ¨í–ˆìŠµë‹ˆë‹¤.");
              return;
            } finally {
              document.querySelector("#loading").classList.remove("active");
            }
            /**
             * collectionDb: "kopis01_ê³µì—°ëª©ë¡"
             * creator: "í™ˆí˜ì´ì§€"
             * language: "kor"
             * referenceIdentifier: "http://www.kopis.or.kr/upload/pfmPoster/PF_PF153974_190903_094953.gif"
             * spatialCoverage: "ì„±ë‚¨ì•„íŠ¸ì„¼í„°"
             * subDescription: "ê³µì—°ìƒíƒœ: ê³µì—°ì™„ë£Œ ì˜¤í”ˆëŸ°: N"
             * subjectCategory: "ì½˜ì„œíŠ¸"
             * temporalCoverage: "2019.12.07~2019.12.07"
             * title: "ì¥ìœ¤ì • ë¼ì´ë¸Œ ì½˜ì„œíŠ¸ [ì„±ë‚¨]"
             * url: "http://www.kopis.or.kr/por/db/pblprfr/pblprfrView.do?menuId=MNU_00020&mt20Id=PF153974#20819"
             */

            // dataì˜ ì¥ì†Œ ì´ë¦„ì„ ë°°ì—´ë¡œ ë§Œë“¬
            let placeArray = [];
            json.forEach((v, i) => {
              placeArray.push(v.spatialCoverage);
            });
            // console.log(placeArray);

            // dataì˜ ì¥ì†Œ ì´ë¦„ì„ ì¤‘ë³µì—†ëŠ” ë°°ì—´ë¡œ ë§Œë“¬
            let placeName = Array.from(new Set(placeArray));
            // console.log("ì§€ë„ì— í‘œì‹œí•œ ì¥ì†Œ");
            // console.log(placeName);

            // placeName ë°˜ë³µì„ ê²€ìƒ‰ í•¨ìˆ˜ íŒŒë¼ë¯¸í„°ë¡œ ë³´ëƒ„
            placeName.forEach((v, i) => {
              // search_map í•¨ìˆ˜ í˜¸ì¶œì„ í†µí•´ ì§€ë„ì— í‘œì‹œ
              search_map(v);
            });
          })();

          /**
           *
           *
           * ì§€ë„ í‘œì‹œ!!
           */
          // ë§ˆì»¤ë¥¼ í´ë¦­í•˜ë©´ ì¥ì†Œëª…ì„ í‘œì¶œí•  ì¸í¬ìœˆë„ìš° ì…ë‹ˆë‹¤
          var infowindow = new kakao.maps.InfoWindow({ zIndex: 1 });

          var mapContainer = document.getElementById("map"), // ì§€ë„ë¥¼ í‘œì‹œí•  div
            mapOption = {
              center: new kakao.maps.LatLng(37.566826, 126.9786567), // ì§€ë„ì˜ ì¤‘ì‹¬ì¢Œí‘œ
              level: 8, // ì§€ë„ì˜ í™•ëŒ€ ë ˆë²¨
            };

          // ì§€ë„ë¥¼ ìƒì„±í•©ë‹ˆë‹¤
          var map = new kakao.maps.Map(mapContainer, mapOption);

          /**
           *
           *
           * ì§€ë„ ê²€ìƒ‰ ë° ë§ˆì»¤ í‘œì‹œ
           * placeNameì—ì„œ ì´ë¦„ì„ ê°€ì ¸ì™€ ì§€ë„ì— ê²€ìƒ‰ í›„ ë§ˆì»¤
           */
          function search_map(queryKeyword) {
            // ì¥ì†Œ ê²€ìƒ‰ ê°ì²´ë¥¼ ìƒì„±í•©ë‹ˆë‹¤
            var ps = new kakao.maps.services.Places();

            // í‚¤ì›Œë“œë¡œ ì¥ì†Œë¥¼ ê²€ìƒ‰í•©ë‹ˆë‹¤
            ps.keywordSearch(queryKeyword, placesSearchCB);

            // í‚¤ì›Œë“œ ê²€ìƒ‰ ì™„ë£Œ ì‹œ í˜¸ì¶œë˜ëŠ” ì½œë°±í•¨ìˆ˜ ì…ë‹ˆë‹¤
            function placesSearchCB(data, status, pagination) {
              if (status === kakao.maps.services.Status.OK) {
                // ê²€ìƒ‰ëœ ì¥ì†Œ ìœ„ì¹˜ë¥¼ ê¸°ì¤€ìœ¼ë¡œ ì§€ë„ ë²”ìœ„ë¥¼ ì¬ì„¤ì •í•˜ê¸°ìœ„í•´
                // LatLngBounds ê°ì²´ì— ì¢Œí‘œë¥¼ ì¶”ê°€í•©ë‹ˆë‹¤
                var bounds = new kakao.maps.LatLngBounds();

                for (var i = 0; i < data.length; i++) {
                  displayMarker(data[0]);
                  bounds.extend(new kakao.maps.LatLng(data[0].y, data[0].x));
                }

                // ê²€ìƒ‰ëœ ì¥ì†Œ ìœ„ì¹˜ë¥¼ ê¸°ì¤€ìœ¼ë¡œ ì§€ë„ ë²”ìœ„ë¥¼ ì¬ì„¤ì •í•©ë‹ˆë‹¤
                map.setBounds(bounds);
              }
            }

            // ì§€ë„ì— ë§ˆì»¤ë¥¼ í‘œì‹œí•˜ëŠ” í•¨ìˆ˜ì…ë‹ˆë‹¤
            function displayMarker(place) {
              // ë§ˆì»¤ë¥¼ ìƒì„±í•˜ê³  ì§€ë„ì— í‘œì‹œí•©ë‹ˆë‹¤
              var marker = new kakao.maps.Marker({
                map: map,
                position: new kakao.maps.LatLng(place.y, place.x),
              });

              // ë§ˆì»¤ì— í´ë¦­ì´ë²¤íŠ¸ë¥¼ ë“±ë¡í•©ë‹ˆë‹¤
              kakao.maps.event.addListener(marker, "click", function () {
                // ë§ˆì»¤ë¥¼ í´ë¦­í•˜ë©´ ì¥ì†Œëª…ì´ ì¸í¬ìœˆë„ìš°ì— í‘œì¶œë©ë‹ˆë‹¤
                infowindow.setContent('<div style="padding:5px;font-size:12px;">' + place.place_name + "</div>");
                infowindow.open(map, marker);
              });
            }
          }

          /**
           *
           *
           * ì§€ë„ í™•ëŒ€ ìˆ˜ì¤€
           */
          // ì§€ë„ ë ˆë²¨ì€ ì§€ë„ì˜ í™•ëŒ€ ìˆ˜ì¤€ì„ ì˜ë¯¸í•©ë‹ˆë‹¤
          // ì§€ë„ ë ˆë²¨ì€ 1ë¶€í„° 14ë ˆë²¨ì´ ìˆìœ¼ë©° ìˆ«ìê°€ ì‘ì„ìˆ˜ë¡ ì§€ë„ í™•ëŒ€ ìˆ˜ì¤€ì´ ë†’ìŠµë‹ˆë‹¤
          function zoomIn() {
            // í˜„ì¬ ì§€ë„ì˜ ë ˆë²¨ì„ ì–»ì–´ì˜µë‹ˆë‹¤
            var level = map.getLevel();

            // ì§€ë„ë¥¼ 1ë ˆë²¨ ë‚´ë¦½ë‹ˆë‹¤ (ì§€ë„ê°€ í™•ëŒ€ë©ë‹ˆë‹¤)
            map.setLevel(7);
          }

          function zoomOut() {
            // í˜„ì¬ ì§€ë„ì˜ ë ˆë²¨ì„ ì–»ì–´ì˜µë‹ˆë‹¤
            var level = map.getLevel();

            // ì§€ë„ë¥¼ 1ë ˆë²¨ ì˜¬ë¦½ë‹ˆë‹¤ (ì§€ë„ê°€ ì¶•ì†Œë©ë‹ˆë‹¤)
            map.setLevel(10);
          }

          /**
           *
           *
           * ì§€ë„ í™•ëŒ€, ì¶•ì†Œ ê°€ëŠ¥ ì—¬ë¶€
           */
          // ë²„íŠ¼ í´ë¦­ì— ë”°ë¼ ì§€ë„ í™•ëŒ€, ì¶•ì†Œ ê¸°ëŠ¥ì„ ë§‰ê±°ë‚˜ í’€ê³  ì‹¶ì€ ê²½ìš°ì—ëŠ” map.setZoomable í•¨ìˆ˜ë¥¼ ì‚¬ìš©í•©ë‹ˆë‹¤
          // function setZoomable(zoomable) {
          //     // ë§ˆìš°ìŠ¤ íœ ë¡œ ì§€ë„ í™•ëŒ€,ì¶•ì†Œ ê°€ëŠ¥ì—¬ë¶€ë¥¼ ì„¤ì •í•©ë‹ˆë‹¤
          //     map.setZoomable(zoomable);
          // }

          /**
           *
           *
           *
           *
           *
           *
           *
           *
           *
           *
           *
           * JANG
           */
          // ì¥ë¥´ ì„ íƒì‹œ ë°°ê²½ìƒ‰ ë³€ê²½
          document.querySelectorAll(".btn1").forEach((v, i) => {
            v.addEventListener("click", (e) => {
              v.classList.toggle("choiced");
              // ë‹¤ìŒ ë‹¨ê³„ ì•ˆë‚´ë¥¼ ìœ„í•œ ìƒ‰ ë³€ê²½
              document.querySelector("#genre_category_title").classList.remove("stepColor");

              setTimeout(() => {
                document.querySelector(".submitBtn").classList.add("stepColor");
              }, 2000);
            });
          });

          // ê²€ìƒ‰ ë²„íŠ¼ í´ë¦­ì‹œ ì¡°ê±´ í™•ì¸

          // document.querySelector("#mag_glass").addEventListener("click", (e) => { // í—¤ë” ë‹ë³´ê¸° í´ë¦­ì‹œ ê°™ì€ í˜ì´ì§€ë¡œ ì´ë™ì´ë¯€ë¡œ ê²€ìƒ‰ì°½ì— í¬ì»¤ìŠ¤ ì¤Œ
          //   e.preventDefault();

          //   document.querySelector("#query").focus();
          // });

          // ì§€ì—­ ì„ íƒì‹œ ê°€ì¥ ë§ˆì§€ë§‰ì— ì„ íƒí•œ ì§€ì—­ ë°°ê²½ìƒ‰ ë³€ê²½
          document.querySelectorAll(".btnJ").forEach((v, i) => {
            v.addEventListener("click", (e) => {
              document.querySelectorAll(".btnJ").forEach((v2, i2) => {
                v2.classList.remove("choiced2");
              });
              v.classList.add("choiced2");
            });
          });

          // ì§€ì—­ ëª©ë¡ ì—´ê¸°
          document.querySelector(".map-category-title").addEventListener("click", (e) => {
            e.currentTarget.classList.toggle("folding");
            if (e.currentTarget.classList.contains("folding")) {
              e.currentTarget.style.transform = "translate(50px, 0)";
              document.querySelector("#map-button-container").style.transform = "translate(50px, 0)";
            } else {
              e.currentTarget.style.transform = "translate(0, 0)";
              document.querySelector("#map-button-container").style.transform = "translate(0, 0)";
            }
          });

          // document.querySelector(".fold").addEventListener("click", (e) => {
          //   e.currentTarget.style.zIndex = "11";
          //   document.querySelector("#map-button-container").style.transform = "translate(0, 0)";
          // });
        </script>
      </div>
      <!-- footer -->
      <div data-include="./inc/footer.html"></div>
      <script src="./assets/js/include.js"></script>
    </div>
  </body>
</html>
